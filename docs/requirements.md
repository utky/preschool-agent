# 要件
幼稚園から送付されるお知らせのPDFを知識として蓄積し各種作業をことができるAIエージェントを構築します。すなわちPDFに由来する知識を使ったRAGを用いたAIエージェントです。

## ユースケース
幼稚園から送付された資料の情報をもとに以下のユースケースをサポートする。

1. 資料に記載された予定や提出依頼をGoogle Calendarへと自動登録する。
2. 資料に記載された写真抽出し画像として閲覧・ダウンロード可能とする。
3. 幼稚園から送付された資料に対する自然言語での問い合わせに応答する。

## 機能
以下のような機能を持つ。

- A) 幼稚園資料のロード
- B) 幼稚園資料の解析
    - テキスト解析
    - 画像解析
- C) 幼稚園資料にもとづく定型処理の自動化
    - カレンダー登録
- D) 幼稚園資料への問い合わせ処理

## 構成
機能は以下の構成要素により実現される。

### バックエンド:
- Google Driveの所定のフォルダに配置されたPDFファイルを定期的に監視する
- Google Driveの所定のフォルダに新しいファイルが配置されたらそれをCloud Storageにコピーする
- Cloud StorageのPDFファイルの内容を解析し構造化して抽出しBigQueryテーブルに保存する
- PDFに含まれる写真は個別にCloud Storageに非構造化データとして保存する
- 写真データから同一人物にはタグ付けをする
- 解析結果として保存したデータに予定や期限に関するものがあればカレンダーに登録する

### フロントエンド:
- BigQueryテーブルを検索知識として以下の問い合わせに柔軟に応答するAIエージェント
    - 将来の予定や提出物などを検索する
    - 将来の予定や提出物に関する情報をカレンダーに登録
    - 自分の家の子供が移っている写真はギャラリー化して表示する

## 利用者
家族数名。認可はGoogle Cloud IAP (Identity-Aware Proxy) を利用し、IAMで許可されたGmailアドレスを持つユーザーのみがアクセスできる形とする。

## 入力データ
幼稚園から定期的に配布されるPDFファイル。

### journal:
不定期刊行のお知らせなどが掲載されている。

```
${title} No.${記事番号} ${和暦} ${year}年 ${month} 月 ${day} 日 (${weekday})
${section}
${content}
${section}
${content}
```

### photo album:
不定期刊行の写真がメインの記事。

構造は不定形。

- 横長のページ
- ページ左上
    - タイトル
    - 執筆者
    - 和暦
    - 園名
- タイル状にセクションが配置される
- タイル状に写真が配置される
- ページ右下
    - 保育内容表

### monthly announcement:
月次で発行される周知事項。

1ページで2アップの構成。
以下の順でコンテンツが配置されている。

- タイトル
- 序文
- スケジュール
- `★` で始まるセクション
- 月度の保育目標

### monthly lunch schedule:
月次給食献立表。

- 刊行月度
- タイトル
- 園名
- 献立表
- 平均栄養価表

### monthly lunch info:
月次の給食に関するお知らせ。

- タイトル
- 刊行月度
- 執筆者
- 序文
- コンテンツ(複数セクション)

## 写真分類機能

## 技術的制約
- Python 3.12 で実装すること
- AIエージェントフレームワーク: ADKを利用すること
- Webフレームワーク: FastAPIを利用すること
- データモデリングフレームワーク: Pydanticを利用すること
- 開発ツール: uv, ty , ruff を利用すること
- エディタはVSCodeを前提とした設定ファイルにすること
- コーディングエージェントはGemini CLIとすること
